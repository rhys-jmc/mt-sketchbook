{"version":3,"sources":["constants.ts","components/Canvas.tsx","components/Modal.tsx","components/PageListItem.tsx","components/PageList.tsx","components/App.tsx","serviceWorker.ts","index.tsx"],"names":["window","width","innerWidth","height","innerHeight","desktopWidth","IS_MOBILE","CANVAS_WIDTH","CANVAS_HEIGHT","Canvas","state","drawing","canvasRef","React","createRef","getCanvasContext","_this","current","getContext","blockScrolling","event","preventDefault","startScrollingBlock","document","addEventListener","passive","stopScrollingBlock","removeEventListener","handleStart","_ref","pageX","pageY","_this$currentCanvasRe","currentCanvasRef","offsetLeft","offsetTop","context","setState","beginPath","moveTo","handleMove","_ref2","_this$currentCanvasRe2","lineTo","stroke","handleEnd","closePath","props","onMouseUp","getImageData","handleMouseDown","_ref3","handleMouseMove","_ref4","handleMouseUp","handleTouchStart","_ref5","_touches$","touches","handleTouchMove","_ref6","_touches$2","handleTouchEnd","imageData","_ref7","this","putImageData","react_default","a","createElement","ref","onMouseDown","onMouseMove","onTouchStart","onTouchMove","onTouchEnd","Component","Modal","open","handleKeyUp","ev","key","closeModal","openModal","callback","_this2","Fragment","render","className","style","display","onClick","stopPropagation","children","components_PageListItem","isActive","label","classnames","disabled","components_PageList","activePageId","onPageClick","pages","map","id","App","newPage","inputRef","handleChange","name","value","target","prevState","Object","objectSpread","defineProperty","objectWithoutProperties","index","newPages","concat","toConsumableArray","slice","handleNewPageClick","focus","handlePageClick","handleSubmit","lastPage","length","ImageData","flexDirection","alignItems","Modal_Modal","submit","onSubmit","htmlFor","autoComplete","type","onChange","pattern","join","undefined","required","Canvas_Canvas","Boolean","location","hostname","match","ReactDOM","src_components_App","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.b6f870c2.chunk.js","sourcesContent":["const { innerWidth: width, innerHeight: height } = window;\n\nconst desktopWidth = width - (130 + 32 * 3);\nconst mobileWidth = width - 16 * 2 - 4 * 2;\n\nconst desktopHeight = height - 116;\nconst mobileHight = height - 208;\n\nexport const IS_MOBILE = desktopWidth < 320;\nexport const CANVAS_WIDTH = IS_MOBILE ? mobileWidth : desktopWidth;\nexport const CANVAS_HEIGHT = IS_MOBILE ? mobileHight : desktopHeight;\n","import React, {\n  Component,\n  MouseEvent,\n  RefObject,\n  TouchEventHandler,\n  MouseEventHandler\n} from \"react\";\nimport { CANVAS_WIDTH, CANVAS_HEIGHT } from \"../constants\";\n\nexport type OnMouseUp = (imageData: ImageData) => void;\n\ninterface CanvasProps {\n  imageData: ImageData;\n  onMouseUp: OnMouseUp;\n}\n\ninterface CanvasState {\n  drawing: boolean;\n}\n\nexport default class Canvas extends Component<CanvasProps, CanvasState> {\n  state = { drawing: false };\n\n  canvasRef: RefObject<HTMLCanvasElement> = React.createRef();\n\n  get currentCanvasRef() {\n    return (\n      this.canvasRef.current || {\n        width: 0,\n        height: 0,\n        offsetLeft: 0,\n        offsetTop: 0\n      }\n    );\n  }\n\n  shouldComponentUpdate({ imageData }: CanvasProps) {\n    return this.props.imageData !== imageData;\n  }\n\n  getCanvasContext = () =>\n    this.canvasRef.current && this.canvasRef.current.getContext(\"2d\");\n\n  blockScrolling = (event: TouchEvent) => {\n    event.preventDefault();\n  };\n\n  startScrollingBlock = () => {\n    document.addEventListener(\"touchstart\", this.blockScrolling, {\n      passive: false\n    });\n    document.addEventListener(\"touchmove\", this.blockScrolling, {\n      passive: false\n    });\n  };\n\n  stopScrollingBlock = () => {\n    document.removeEventListener(\"touchstart\", this.blockScrolling);\n    document.removeEventListener(\"touchmove\", this.blockScrolling);\n  };\n\n  handleStart = ({ pageX, pageY }: { pageX: number; pageY: number }) => {\n    const { offsetLeft, offsetTop } = this.currentCanvasRef;\n    const context = this.getCanvasContext();\n\n    if (context) {\n      this.setState({ drawing: true }, () => {\n        context.beginPath();\n        context.moveTo(pageX - offsetLeft, pageY - offsetTop);\n      });\n    }\n  };\n\n  handleMove = ({ pageX, pageY }: { pageX: number; pageY: number }) => {\n    if (this.state.drawing) {\n      const { offsetLeft, offsetTop } = this.currentCanvasRef;\n      const context = this.getCanvasContext();\n\n      if (context) {\n        context.lineTo(pageX - offsetLeft, pageY - offsetTop);\n        context.stroke();\n      }\n    }\n  };\n\n  handleEnd = () => {\n    this.setState({ drawing: false }, () => {\n      const context = this.getCanvasContext();\n\n      if (context) {\n        context.closePath();\n\n        this.props.onMouseUp(\n          context.getImageData(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT)\n        );\n      }\n    });\n  };\n\n  handleMouseDown: MouseEventHandler<HTMLCanvasElement> = ({ pageX, pageY }) =>\n    this.handleStart({ pageX, pageY });\n\n  handleMouseMove: MouseEventHandler<HTMLCanvasElement> = ({ pageX, pageY }) =>\n    this.handleMove({ pageX, pageY });\n\n  handleMouseUp: MouseEventHandler<HTMLCanvasElement> = () => this.handleEnd();\n\n  handleTouchStart: TouchEventHandler<HTMLCanvasElement> = ({ touches }) => {\n    const { pageX, pageY } = touches[0];\n\n    this.startScrollingBlock();\n\n    return this.handleStart({ pageX, pageY });\n  };\n\n  handleTouchMove: TouchEventHandler<HTMLCanvasElement> = ({ touches }) => {\n    const { pageX, pageY } = touches[0];\n\n    return this.handleMove({ pageX, pageY });\n  };\n\n  handleTouchEnd: TouchEventHandler<HTMLCanvasElement> = () => {\n    this.stopScrollingBlock();\n\n    this.handleEnd();\n  };\n\n  render() {\n    const context = this.getCanvasContext();\n\n    if (context) {\n      context.putImageData(this.props.imageData, 0, 0);\n    }\n\n    return (\n      <canvas\n        width={CANVAS_WIDTH}\n        height={CANVAS_HEIGHT}\n        ref={this.canvasRef}\n        onMouseDown={this.handleMouseDown}\n        onMouseMove={this.handleMouseMove}\n        onMouseUp={this.handleMouseUp}\n        onTouchStart={this.handleTouchStart}\n        onTouchMove={this.handleTouchMove}\n        onTouchEnd={this.handleTouchEnd}\n      />\n    );\n  }\n}\n","import React, { Component, ReactNode, KeyboardEventHandler } from \"react\";\nimport \"./Modal.css\";\n\nexport type CloseOpenModalFunction = (callback?: () => void) => void;\n\ninterface ModalRenderProps {\n  closeModal: CloseOpenModalFunction;\n  openModal: CloseOpenModalFunction;\n}\n\ninterface ModalProps {\n  children(childrenProps: ModalRenderProps): ReactNode;\n  render(renderProps: ModalRenderProps): ReactNode;\n}\n\ninterface ModalState {\n  open: boolean;\n}\n\nexport default class Modal extends Component<ModalProps, ModalState> {\n  state = { open: false };\n\n  componentDidMount() {\n    document.addEventListener(\"keyup\", this.handleKeyUp);\n  }\n\n  componentWillUnmount() {\n    document.removeEventListener(\"keyup\", this.handleKeyUp);\n  }\n\n  handleKeyUp = (ev: KeyboardEvent) => {\n    if (ev.key === \"Escape\") {\n      this.closeModal();\n    }\n  };\n\n  closeModal: CloseOpenModalFunction = () => {\n    this.setState({ open: false });\n  };\n\n  openModal: CloseOpenModalFunction = (callback?: () => void) => {\n    this.setState({ open: true }, callback);\n  };\n\n  render() {\n    const { closeModal, openModal } = this;\n\n    return (\n      <>\n        {this.props.render({ closeModal, openModal })}\n        {this.state.open && (\n          <div\n            className=\"ModalBackground\"\n            style={open ? {} : { display: \"none\" }}\n            onClick={() => this.closeModal()}\n          >\n            <div\n              className=\"Modal\"\n              onClick={event => {\n                event.stopPropagation();\n              }}\n            >\n              {this.props.children({ closeModal, openModal })}\n            </div>\n          </div>\n        )}\n      </>\n    );\n  }\n}\n","import React, { MouseEventHandler } from \"react\";\nimport classnames from \"classnames\";\nimport \"./PageListItem.css\";\n\ninterface PageListItemProps {\n  isActive: boolean;\n  label: string;\n  onClick: MouseEventHandler<HTMLButtonElement>;\n}\n\nexport default ({ isActive, label, onClick }: PageListItemProps) => (\n  <li className=\"PageListItem\">\n    <button\n      className={classnames(\"ItemButton\", isActive && \"ItemButtonActive\")}\n      onClick={onClick}\n      disabled={isActive}\n    >\n      {label}\n    </button>\n  </li>\n);\n","import React from \"react\";\nimport { Page } from \"../types\";\nimport PageListItem from \"./PageListItem\";\nimport \"./PageList.css\";\n\nexport default ({\n  activePageId,\n  onPageClick,\n  pages\n}: {\n  activePageId: number;\n  onPageClick(id: number): () => void;\n  pages: Page[];\n}) => (\n  <ul className=\"PageList\">\n    {pages.map(({ id, label }) => (\n      <PageListItem\n        key={id}\n        isActive={id === activePageId}\n        label={label}\n        onClick={onPageClick(id)}\n      />\n    ))}\n  </ul>\n);\n","import React, {\n  Component,\n  ChangeEvent,\n  EventHandler,\n  FormEventHandler,\n  KeyboardEventHandler,\n  RefObject\n} from \"react\";\nimport Canvas, { OnMouseUp } from \"./Canvas\";\nimport Modal, { CloseOpenModalFunction } from \"./Modal\";\nimport PageListItem from \"./PageListItem\";\nimport { CANVAS_WIDTH, CANVAS_HEIGHT, IS_MOBILE } from \"../constants\";\nimport { Page } from \"../types\";\nimport \"./App.css\";\nimport PageList from \"./PageList\";\n\ninterface AppState {\n  activePageId?: number;\n  newPage: string;\n  pages: Page[];\n}\n\nclass App extends Component<{}, AppState> {\n  state: AppState = { newPage: \"\", pages: [] };\n\n  inputRef: RefObject<HTMLInputElement> = React.createRef();\n\n  handleChange = (\n    name: keyof AppState\n  ): EventHandler<ChangeEvent<HTMLInputElement>> => ({ target: { value } }) => {\n    this.setState(prevState => ({ ...prevState, [name]: value }));\n  };\n\n  handleMouseUp: OnMouseUp = imageData => {\n    this.setState(({ pages, ...prevState }) => {\n      if (typeof prevState.activePageId !== \"undefined\") {\n        const index = prevState.activePageId;\n\n        const newPage = {\n          ...pages[index],\n          imageData\n        };\n\n        // replace existing page with new image data\n        const newPages = [\n          ...pages.slice(0, index),\n          newPage,\n          ...pages.slice(index + 1)\n        ];\n\n        return { ...prevState, pages: newPages };\n      }\n\n      return { pages, ...prevState };\n    });\n  };\n\n  handleNewPageClick = (openModal: CloseOpenModalFunction) => () => {\n    openModal(() => {\n      if (this.inputRef.current) {\n        this.inputRef.current.focus();\n      }\n    });\n  };\n\n  handlePageClick = (id: number) => () => {\n    this.setState({ activePageId: id });\n  };\n\n  handleSubmit = (\n    closeModal: CloseOpenModalFunction\n  ): FormEventHandler<HTMLFormElement> => event => {\n    event.preventDefault();\n\n    this.setState(\n      state => {\n        const lastPage = state.pages[state.pages.length - 1];\n        const newPage = {\n          id: lastPage ? lastPage.id + 1 : 0,\n          imageData: new ImageData(CANVAS_WIDTH, CANVAS_HEIGHT),\n          label: state.newPage\n        };\n\n        return {\n          newPage: \"\",\n          pages: [...state.pages, newPage]\n        };\n      },\n      () => {\n        closeModal();\n        this.handlePageClick(this.state.pages.slice(-1)[0].id)();\n      }\n    );\n  };\n\n  render() {\n    return (\n      <>\n        <h1>Sketchbook</h1>\n        <div\n          className=\"Container\"\n          style={{\n            flexDirection: IS_MOBILE ? \"column\" : \"row\",\n            alignItems: IS_MOBILE ? \"center\" : \"flex-start\"\n          }}\n        >\n          <div>\n            <div>\n              <Modal\n                render={({ openModal }) => (\n                  <button\n                    className=\"btn large primary\"\n                    onClick={this.handleNewPageClick(openModal)}\n                  >\n                    + New Page\n                  </button>\n                )}\n              >\n                {({ closeModal }) => {\n                  const submit = this.handleSubmit(closeModal);\n\n                  return (\n                    <form className=\"Form\" onSubmit={submit}>\n                      <label htmlFor=\"page-name\">Page Name:</label>\n                      <input\n                        autoComplete=\"off\"\n                        name=\"page-name\"\n                        id=\"page-name\"\n                        type=\"text\"\n                        value={this.state.newPage}\n                        onChange={this.handleChange(\"newPage\")}\n                        ref={this.inputRef}\n                        pattern={\n                          this.state.pages.length\n                            ? `^(?:(?!(^${this.state.pages\n                                .map(({ label }) => label)\n                                .join(\"$)|(^\")}$)).)*$`\n                            : undefined\n                        }\n                        required\n                      />\n                      <button className=\"large primary\" type=\"submit\">\n                        Create New Page\n                      </button>\n                    </form>\n                  );\n                }}\n              </Modal>\n            </div>\n            {typeof this.state.activePageId !== \"undefined\" && (\n              <div>\n                <PageList\n                  pages={this.state.pages}\n                  activePageId={this.state.activePageId}\n                  onPageClick={this.handlePageClick}\n                />\n              </div>\n            )}\n          </div>\n          {typeof this.state.activePageId !== \"undefined\" && (\n            <Canvas\n              imageData={this.state.pages[this.state.activePageId].imageData}\n              onMouseUp={this.handleMouseUp}\n            />\n          )}\n        </div>\n      </>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./components/App\";\nimport * as serviceWorker from \"./serviceWorker\";\nimport \"./index.css\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}